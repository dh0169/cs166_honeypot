Here‚Äôs a comprehensive **Malware Analysis Cheat Sheet** written in Markdown format suitable for a GitHub `README.md`.

---

# Malware Analysis Cheat Sheet

A comprehensive guide for using tools in your malware analysis lab.

---

## Table of Contents
1. [Introduction](#introduction)
2. [Static Analysis](#static-analysis)
3. [Dynamic Analysis](#dynamic-analysis)
4. [Network Analysis](#network-analysis)
5. [Reverse Engineering](#reverse-engineering)
6. [Forensic Analysis](#forensic-analysis)
7. [Emulation and Virtualization](#emulation-and-virtualization)
8. [Automation](#automation)
9. [Advanced Configuration](#advanced-configuration)
10. [Best Practices](#best-practices)

---

## Introduction

This guide provides an overview of tools and techniques for malware analysis, covering static analysis, dynamic analysis, network traffic inspection, reverse engineering, and automation.

---

## Static Analysis

### 1. **YARA**
- **Purpose**: Identifies and classifies malware using patterns.
- **Commands**:
  ```bash
  yara -r /opt/yara-rules/ /path/to/sample
  ```
- Update rules:
  ```bash
  cd /opt/yara-rules && git pull
  ```

### 2. **Binwalk**
- **Purpose**: Extracts embedded files and examines binary data.
- **Commands**:
  ```bash
  binwalk -e /path/to/sample
  ```

### 3. **Strings**
- **Purpose**: Extracts readable text from binaries.
- **Commands**:
  ```bash
  strings /path/to/sample | less
  ```

### 4. **ClamAV**
- **Purpose**: Scans for known malware signatures.
- **Commands**:
  ```bash
  clamscan /path/to/sample
  ```

---

## Dynamic Analysis

### 1. **Cuckoo Sandbox**
- **Purpose**: Automated dynamic analysis of malware.
- **Commands**:
  ```bash
  cuckoo
  cuckoo submit /path/to/sample
  ```

### 2. **Strace & Ltrace**
- **Purpose**: Monitors system and library calls.
- **Commands**:
  ```bash
  strace -f -o trace.log /path/to/sample
  ltrace -o ltrace.log /path/to/sample
  ```

### 3. **GDB**
- **Purpose**: Debug and analyze executable behavior.
- **Commands**:
  ```bash
  gdb /path/to/sample
  run
  ```

---

## Network Analysis

### 1. **Wireshark**
- **Purpose**: Captures and analyzes network packets.
- **Command**: Start Wireshark GUI and select an interface:
  ```bash
  wireshark
  ```

### 2. **Zeek**
- **Purpose**: Detects and logs network behavior.
- **Commands**:
  ```bash
  zeek -r /path/to/pcap
  ```

### 3. **Tcpdump**
- **Purpose**: Captures and inspects network packets.
- **Commands**:
  ```bash
  tcpdump -i eth0 -w capture.pcap
  tcpdump -r capture.pcap
  ```

---

## Reverse Engineering

### 1. **Radare2**
- **Purpose**: Disassembles and analyzes binaries.
- **Commands**:
  ```bash
  r2 /path/to/sample
  aa  # Analyze all
  pdf @ main  # Disassemble main function
  ```

### 2. **Ghidra**
- **Purpose**: Provides a decompiler and disassembler for binaries.
- **Usage**:
  - Launch GUI: `/path/to/ghidra/ghidraRun`
  - Import sample for analysis.

### 3. **IDA Free**
- **Purpose**: Interactive Disassembler for reverse engineering.
- **Usage**:
  - Launch GUI: `/opt/ida/idafree`
  - Load a sample for interactive analysis.

---

## Forensic Analysis

### 1. **Autopsy**
- **Purpose**: Forensic analysis of file systems and disk images.
- **Commands**:
  ```bash
  autopsy
  ```

### 2. **Sleuthkit**
- **Purpose**: Examines disk images.
- **Commands**:
  ```bash
  fls /path/to/image
  icat /path/to/image inode_number
  ```

### 3. **Foremost**
- **Purpose**: Recovers deleted files from disk images.
- **Commands**:
  ```bash
  foremost -i /path/to/image -o /output/directory
  ```

---

## Emulation and Virtualization

### 1. **QEMU**
- **Purpose**: Emulates various ISAs.
- **Commands**:
  ```bash
  qemu-system-x86_64 -hda /path/to/sample.img
  ```

### 2. **Docker**
- **Purpose**: Sandboxes environments for dynamic analysis.
- **Commands**:
  ```bash
  docker run --rm -it image_name
  ```

### 3. **Virt-Manager**
- **Purpose**: Manages virtual machines.
- **Usage**:
  - Launch GUI: `virt-manager`
  - Create and manage VMs.

---

## Automation

### 1. **Cuckoo Sandbox**
- Automates dynamic malware analysis.
  ```bash
  cuckoo
  cuckoo submit /path/to/sample
  ```

### 2. **Python Scripting**
- Leverage Python for custom analysis.
- Example:
  ```python
  import yara
  rules = yara.compile('/path/to/rule.yar')
  matches = rules.match('/path/to/sample')
  print(matches)
  ```

---

## Advanced Configuration

### Disable Address Space Layout Randomization (ASLR)
```bash
echo 0 > /proc/sys/kernel/randomize_va_space
```

### Enable Core Dumps
```bash
ulimit -c unlimited
```

---

## Best Practices

1. **Isolate the Analysis Environment**:
   - Use dedicated VMs or containers for analysis.

2. **Keep Tools Updated**:
   - Regularly update tools like YARA and Ghidra.

3. **Beware of Execution Risks**:
   - Always analyze malware in an isolated and controlled environment.

4. **Log Everything**:
   - Use tools like Wireshark, Strace, and Ltrace to maintain logs.

5. **Practice**:
   - Analyze real-world samples in controlled environments.

---

## References
- [YARA Documentation](https://virustotal.github.io/yara/)
- [Radare2 Official Website](https://rada.re/n/)
- [Ghidra User Guide](https://ghidra-sre.org/)
- [Cuckoo Sandbox](https://cuckoosandbox.org/)
- [Wireshark Documentation](https://www.wireshark.org/)

---

Happy Analyzing! üïµÔ∏è‚Äç Ô∏è(Generated with chatGPT)

--- 

